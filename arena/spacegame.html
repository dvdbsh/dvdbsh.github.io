<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Space Flap</title>
    <link href="https://fonts.googleapis.com/css2?family=Karla:wght@400;800&family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; }
        canvas {
            display: block;
            background-color: #330a76;
            background-image: url(https://www.transparenttextures.com/patterns/stardust.png);
            margin: auto;
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
        }
        #startButton, #restartButton {
            display: none;
            position: absolute;
            left: 50%;
            top: 60%;
            transform: translate(-50%, -50%);
            font-size: 20px;
            padding: 15px;
            cursor: pointer;
            border: 2px solid #090909;
            background-color: #990099;
            color: #eee;
            border-radius: 8px;
            box-shadow: 7px 7px 0px #090909;
			font-family: 'Roboto Mono';
        }
        #instructions {
            display: none;
            position: absolute;
            width: 100%;
            text-align: center;
            top: 30%;
            font-size: 20px;
            color: white;
			font-family: 'Roboto Mono';
        }
    </style>
</head>
<body>
    <canvas id="gameCanvas"></canvas>
    <div id="instructions">Click or tap to make the spaceship fly!<p>Avoid the planets to score points!</div>
    <button id="startButton">Start Game</button>
    <button id="restartButton">Restart Game</button>
    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const spaceshipImg = new Image();
        const wiggleImg = new Image();
        const planetImgs = [
            new Image(), new Image(), new Image(),
            new Image(), new Image(), new Image()  // Additional planets
        ];
        let imagesLoaded = 0;

        function imageLoaded() {
            imagesLoaded++;
            if (imagesLoaded === 8) { // Including spaceship, wiggle, and six planets
                showStartScreen();
            }
        }

        spaceshipImg.onload = wiggleImg.onload = imageLoaded;
        planetImgs.forEach(img => img.onload = imageLoaded);

        spaceshipImg.src = 'https://res.cloudinary.com/di8j84ent/image/upload/q_auto/v1715475408/spaceship-sprite_w3gb6f.svg';
        wiggleImg.src = 'https://res.cloudinary.com/di8j84ent/image/upload/q_auto/v1715536531/wiggle_znkcd5.svg';
        planetImgs[0].src = 'https://res.cloudinary.com/di8j84ent/image/upload/v1715475420/planet3-sprite_xrlzg6.png';
        planetImgs[1].src = 'https://res.cloudinary.com/di8j84ent/image/upload/v1715475427/planet1-sprite_jjv5jp.png';
        planetImgs[2].src = 'https://res.cloudinary.com/di8j84ent/image/upload/v1715475424/planet2-sprite_hlvcbm.png';
        planetImgs[3].src = 'https://res.cloudinary.com/di8j84ent/image/upload/v1715523872/planet4-sprite_wkahed.png';
        planetImgs[4].src = 'https://res.cloudinary.com/di8j84ent/image/upload/v1715523868/planet5-sprite_s6xhyf.png';
        planetImgs[5].src = 'https://res.cloudinary.com/di8j84ent/image/upload/v1715523865/planet6-sprite_agttqs.png';

        let spaceship, planets, frame, score, gameOver, scrollOffset = 0;
        const spaceshipWidth = 60;
        const spaceshipHeight = 30;

        function init() {
            spaceship = { x: 100, y: canvas.height / 2, vy: 0 };
            planets = [];
            frame = 0;
            score = 0;
            gameOver = false;
            scrollOffset = 0;
            gameLoop();
            startButton.style.display = 'none';
            restartButton.style.display = 'none';
            instructions.style.display = 'none';
        }

        window.addEventListener('resize', resizeCanvas);
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }

        startButton.addEventListener('click', startGame);
        restartButton.addEventListener('click', init);
        canvas.addEventListener('click', function() {
            if (!gameOver) {
                spaceship.vy = -5;
            }
        });

        function startGame() {
            init();
        }

        function drawSpaceship() {
            ctx.drawImage(spaceshipImg, spaceship.x, spaceship.y, spaceshipWidth, spaceshipHeight);
        }

        function updateSpaceship() {
            spaceship.vy += 0.1;
            spaceship.y += spaceship.vy;
            if (spaceship.y > canvas.height - spaceshipHeight || spaceship.y < 0) {
                endGame();
            }
        }

        function drawPlanets() {
            planets.forEach(planet => {
                const size = planet.size * 50;
                ctx.drawImage(planet.img, planet.x, planet.y, size, size);
            });
        }

        function updatePlanets() {
            if (frame % 100 === 0) {
                const size = Math.random() * 0.5 + 0.5;
                const y = Math.random() * (canvas.height - (size * 50));
                planets.push({
                    x: canvas.width,
                    y,
                    img: planetImgs[Math.floor(Math.random() * planetImgs.length)],
                    size: size,
                    passed: false
                });
            }
            planets.forEach(planet => {
                planet.x -= 2;
                if (!planet.passed && planet.x + planet.size * 50 < spaceship.x) {
                    planet.passed = true;
                    score++;
                }
            });
            planets = planets.filter(planet => planet.x + planet.size * 50 > 0);
        }

        function checkCollision() {
            planets.forEach(planet => {
                const size = planet.size * 50;
                if (spaceship.x < planet.x + size && spaceship.x + spaceshipWidth > planet.x &&
                    spaceship.y < planet.y + size && spaceship.y + spaceshipHeight > planet.y) {
                    endGame();
                }
            });
        }

        function scoreDisplay() {
            ctx.fillStyle = 'white';
            ctx.font = '24px Roboto Mono';
            ctx.fillText(`Score: ${score}`, 20, 30);
        }

        function drawBorders() {
            const patternHeight = 30;
            const patternRepeat = Math.ceil(canvas.width / wiggleImg.width) + 1;
            scrollOffset = (scrollOffset - 2) % wiggleImg.width;

            ctx.save();
            ctx.translate(scrollOffset, 0);
            for (let i = -1; i < patternRepeat; i++) {
                ctx.drawImage(wiggleImg, i * wiggleImg.width, 0, wiggleImg.width, patternHeight);
                ctx.save();
                ctx.scale(1, -1);
                ctx.drawImage(wiggleImg, i * wiggleImg.width, -canvas.height, wiggleImg.width, patternHeight);
                ctx.restore();
            }
            ctx.restore();
        }

        function gameLoop() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawBorders();
            drawSpaceship();
            updateSpaceship();
            drawPlanets();
            updatePlanets();
            checkCollision();
            scoreDisplay();
            frame++;
            if (!gameOver) {
                requestAnimationFrame(gameLoop);
            }
        }

        function endGame() {
            gameOver = true;
            ctx.fillText("Game Over!", canvas.width / 2 - 50, canvas.height / 2);
            restartButton.style.display = 'block';
        }

        function showStartScreen() {
            instructions.style.display = 'block';
            startButton.style.display = 'block';
            ctx.fillStyle = '#44148f';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
        }
        window.onload = resizeCanvas;

    </script>
</body>
</html>
